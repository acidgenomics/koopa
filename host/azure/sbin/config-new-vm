#!/usr/bin/env bash

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../include/header.sh"

_koopa_help "$@"
_koopa_assert_has_sudo
_koopa_deactivate_envs

sudo chown -R root:wheel /usr/local
sudo chmod 2775 /usr/local

# > sudo crontab -e
# > @reboot /usr/local/koopa/host/azure/config/etc/reboot.sh

sudo ln -fnsv \
    /usr/local/koopa/host/azure/config/etc/profile.d/constellation.sh \
    /etc/profile.d/.

install-rhel7-base
remove-rhel7-rpm-cruft

install-cellar-coreutils
install-cellar-bash
install-cellar-zsh
install-openjdk
install-cellar-r
install-cellar-python
install-cellar-vim
install-cellar-neovim
install-cellar-emacs
install-cellar-tmux
install-cellar-git
install-rstudio-server
install-cellar-htop
install-cellar-shellcheck

install-cellar-neofetch
install-cellar-gnupg

install-cellar-proj
install-cellar-gdal

install-cellar-hdf5

# Perl
# Ruby
# Rust

rm -frv ~/.virtualenvs
venv-create-base

# miniconda3
sudo mkdir /data00/miniconda3
sudo chown mike:wheel /data00/miniconda3
sudo chmod 2775 /data00/miniconda3
sudo ln -fnsv /data00/miniconda3 /usr/local/miniconda3

# R site library
sudo mkdir /data00/R
sudo chown mike:wheel /data00/R
sudo chmod 2775 /data00/R
rsync-r-site-library

update-vm
koopa update
koopa check
