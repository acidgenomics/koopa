#!/usr/bin/env bash
set -Eeu -o pipefail

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../include/header.sh"

# Install latest version of R.
# https://cran.r-project.org/bin/linux/debian/

release="$(lsb_release -s -c)"

# Release is signed by Johannes Ranke <jranke@uni-bremen.de>.
# Refer to 'Secure apt' section for details.
sudo apt-key adv \
    --keyserver keys.gnupg.net \
    --recv-key E19F5F87128899B192B1A2C2AD5F960A256A04AF

# Modify '/etc/apt/sources.list' file.
sudo add-apt-repository "deb https://cloud.r-project.org/bin/linux/debian ${release}-cran35/"

sudo apt-get update
sudo apt-get -y install r-base r-base-dev

_koopa_link_r_etc
_koopa_link_r_site_library

# Avoid write failure to 'doc/' here upon package update.
_koopa_set_permissions /usr/share/R
