#!/usr/bin/env bash
set -Eeu -o pipefail

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../include/header.sh"

# """
# Install latest version of R.
# - https://cran.r-project.org/bin/linux/debian/
# - https://cran.r-project.org/bin/linux/ubuntu/README.html
# """

_koopa_exit_if_installed R

_koopa_h1 "Installing R."

_koopa_apt_import_r_key
_koopa_apt_add_r_repo

sudo apt-get update
sudo DEBIAN_FRONTEND=noninteractive \
    apt-get \
        --no-install-recommends \
        --quiet \
        --yes \
        install \
            r-base \
            r-base-dev

_koopa_link_r_etc
_koopa_link_r_site_library

# Avoid write failure to 'doc/' here upon package update.
_koopa_set_permissions --recursive /usr/share/R
