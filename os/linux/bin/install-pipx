#!/usr/bin/env bash

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../include/header.sh"
_koopa_assert_has_no_args "$@"
_koopa_assert_has_no_envs
_koopa_assert_is_installed pip python3

_koopa_message "Installing pipx."

python_exe="$(_koopa_realpath "python3")"
_koopa_message "Python: ${python_exe}"

python3 \
    -m pip install \
    --no-warn-script-location \
    --user \
    pipx

# This recommended step will modify shell RC file, which we don't want.
# > python3 -m pipx ensurepath

envs=(
    black
    flake8
    pyflakes
    pylint
    pytest
)

for env in "${envs[@]}"
do
    # Can pass '--force' flag here to force reinstall.
    "${HOME}/.local/bin/pipx" install "$env"
done

_koopa_message "pipx installed successfully at '${HOME}/.local/pipx."
_koopa_note "Restart the shell."
