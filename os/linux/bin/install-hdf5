#!/usr/bin/env bash

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../include/header.sh"

_koopa_install_cellar --name="hdf5" --name-fancy="HDF5" "$@"

_koopa_assert_is_installed gfortran
minor_version="$(_koopa_major_minor_version "$version")"

file="hdf5-${version}.tar.gz"
url="https://support.hdfgroup.org/ftp/HDF5/releases/hdf5-${minor_version}/\
hdf5-${version}/src/${file}"
_koopa_download "$url"
_koopa_extract "$file"
cd "hdf5-${version}" || exit 1
./configure \
    --prefix="$prefix" \
    --enable-cxx \
    --enable-fortran
make --jobs="$jobs"
# > make check
make install
