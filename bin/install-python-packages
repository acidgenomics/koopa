#!/usr/bin/env bash
set -Eeu -o pipefail

KOOPA_PREFIX="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." \
    >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${KOOPA_PREFIX}/shell/bash/include/header.sh"

_koopa_assert_has_no_envs
_koopa_assert_is_installed python3

if ! _koopa_is_installed pip3
then
    _koopa_install_pip
fi

if ! _koopa_is_installed pipx
then
    _koopa_install_pipx
fi

# pip                                                                     # {{{1
# ==============================================================================

_koopa_h1 "Installing pip packages."
_koopa_dl "Site library" "$(_koopa_python_site_packages_prefix)"

pkgs=(
    black
    flake8
    logbook
    numpy
    pandas
    pyflakes
    pylint
    pytest
    six
)

_koopa_dl "Packages" "$(_koopa_to_string "${pkgs[@]}")"

python3 -m pip install \
    --no-warn-script-location \
    "${pkgs[@]}"

if _koopa_is_cellar python3
then
    _koopa_link_cellar python
fi
