#!/usr/bin/env bash

script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" &>/dev/null && pwd -P)"
# shellcheck source=/dev/null
source "${script_dir}/../shell/bash/include/header.sh"

koopa::assert_has_no_args "$@"

name="Rcheck"
source_repo="https://github.com/acidgenomics/${name}.git"
target_dir="$(koopa::local_app_prefix)/${name}"
link_name=".${name}"

koopa::install_start "$name"

# This will clone the Git repo once, if necessary.
if [[ ! -d "$target_dir" ]]
then
    koopa::h2 "Downloading ${name} to '${target_dir}'."
    (
        mkdir -pv "$target_dir"
        git clone "$source_repo" "$target_dir"
    ) 2>&1 | tee "$(koopa::tmp_log_file)"
fi

# Add symlink in current working directory.
ln -fnsv "$target_dir" "$link_name"

koopa::install_success "$name"
