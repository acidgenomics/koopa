#!/usr/bin/env bash
set -Eeu -o pipefail

# shellcheck source=/dev/null
source "$(koopa header bash)"

source_repo="git@github.com:acidgenomics/Rcheck.git"
config_dir="$(_koopa_config_dir)"
clone_dir="${config_dir}/Rcheck"
link_name=".Rcheck"



# Usage                                                                     {{{1
# ==============================================================================

usage() {
cat << EOF
usage: install-rcheck [--help|-h]

Install Rcheck scripts for R package locally.

optional arguments:
    --help, -h
        Show this help message and exit.

details:
    Run this script inside a git repo where you want to enable Rcheck CI.
    Git repo will be cloned into koopa config, if necessary.
    Symlink will be added at '${link_name}'.

    Source repo:
        ${source_repo}
    Target clone:
        ${clone_dir}'

note:
    Bash script.
    Updated 2019-07-31.
EOF
}

_koopa_help "$@"



# Script                                                                    {{{1
# ==============================================================================

if [[ ! -d "$clone_dir" ]]
then
    rm -frv "$clone_dir"
    git clone "$source_repo" "$clone_dir"
fi

# Add symlink in current working directory.
ln -fnsv "$clone_dir" "$link_name"
