#!/usr/bin/env bash

KOOPA_PREFIX="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." &>/dev/null && pwd -P)"
# shellcheck source=/dev/null
source "${KOOPA_PREFIX}/shell/bash/include/header.sh"

_koopa_assert_has_no_args "$@"

name="Rcheck"
source_repo="https://github.com/acidgenomics/${name}.git"
target_dir="$(_koopa_local_app_prefix)/${name}"
link_name=".${name}"

_koopa_install_start "$name"

# This will clone the Git repo once, if necessary.
if [[ ! -d "$target_dir" ]]
then
    _koopa_h2 "Downloading ${name} to '${target_dir}'."
    (
        mkdir -pv "$target_dir"
        git clone "$source_repo" "$target_dir"
    ) 2>&1 | tee "$(_koopa_tmp_log_file)"
fi

# Add symlink in current working directory.
ln -fnsv "$target_dir" "$link_name"

_koopa_install_success "$name"
