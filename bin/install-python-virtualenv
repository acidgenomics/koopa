#!/usr/bin/env bash
set -Eeu -o pipefail

# Set up python virtual environment.

# Check that Python and virtualenv are installed.
command -v python
# command -v virtualenv

# Ensure virtualenv is deactivated.
if [[ -x "$(command -v deactivate)" ]]
then
    echo "Error: virtualenv is active." >&2
    exit 1
fi

env_base_dir="${HOME}/.virtualenvs"

env_name="${1:-}"
if [[ -z "$env_name" ]]
then
    env_name="default"
fi

env_dir="${env_base_dir}/${env_name}"
rm -rf "$env_dir"

# Python 2 method (deprecated)
# > virtualenv "$env_dir" --system-site-packages

python3 -m venv "$env_dir"

echo "Python ${env_name} virtual environment installed successfully."
echo "Source the 'activate' binary in your current shell session to activate."
