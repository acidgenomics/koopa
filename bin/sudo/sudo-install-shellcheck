#!/usr/bin/env bash
set -Eeuo pipefail

# ShellCheck
#
# See also:
# - Install ShellCheck from source
#   https://github.com/koalaman/shellcheck#compiling-from-source
# - Install GHC and cabal-install from source
#   https://www.haskell.org/downloads/linux/

prefix="$KOOPA_PREFIX"
build_dir="${KOOPA_TMP}/build/shellcheck"

version="0.6.0"

echo "Copying ${version} binary version to ${prefix}."
(
    rm -rf "$build_dir"
    mkdir -p "$build_dir"
    cd "$build_dir"
    wget -qO- "https://storage.googleapis.com/shellcheck/shellcheck-v${version}.linux.x86_64.tar.xz" | tar -xJv
    sudo cp "shellcheck-v${version}/shellcheck" "${prefix}/bin"
    rm -rf "$build_dir"
)

echo "shellcheck installed successfully."
command -v shellcheck
shellcheck --version
