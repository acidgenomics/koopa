#!/usr/bin/env Rscript

options(
    "error" = quote(quit(status = 1L)),
    "warning" = quote(quit(status = 1L))
)

args <- commandArgs(trailingOnly = FALSE)
whichFile <- grep(pattern = "--file", x = args)
file <- args[whichFile]
file <- sub(pattern = "^--file=", replacement = "", x = file)
koopaPrefix <- normalizePath(dirname(dirname(file)))
source(file.path(koopaPrefix, "lang", "r", "include", "header.R"))

if (!requireNamespace("bb8", quietly = TRUE)) {
    message("bb8 package is required but not installed. Skipping.")
    quit()
}

remove(
    pkgs = c(
        "Matrix.utils",
        "SDMTools",
        "bioverbs",
        "brio",
        "freerange",
        "transformer"
    )
)

stopifnot(hasGitHubPAT)
bb8::updatePackages()
