#!/usr/bin/env bash
set -Eeuxo pipefail

# Install Miniconda
# https://conda.io/miniconda.html

prefix="${KOOPA_PREFIX}/miniconda3"

# FIXME SWITCH TO CASE.

case "$OSTYPE" in
    linux-gnu) script="Miniconda3-latest-Linux-x86_64.sh";;
      darwin*) script="Miniconda3-latest-MacOSX-x86_64.sh";;
            *) echo "${OSTYPE} is not supported."; exit 1;;
esac

echo "Downloading Miniconda installer..."
curl -O "https://repo.continuum.io/miniconda/${script}"

# Useful flags:
# - `-b`: Install without prompting.
# - `-p`: Path prefix.

bash "${script} -b -p ${prefix}"

cat << EOF

conda installed successfully.
Export "CONDA_EXE" in bashrc above koopa activation step and reload the shell.
Use "command -v conda" to check the path.

EOF
