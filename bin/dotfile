#!/usr/bin/env bash
set -Eeuxo pipefail

# Add dot file(s).
# Modified 2019-06-13.

from_name="$1"
to_name="${2:-}"

dot_dir="${KOOPA_DIR}/dotfiles"
if [[ ! -d "$dot_dir" ]]
then
    >&2 echo "Error: ${dot_dir} missing."
    exit 1
fi

if [[ -z "$to_name" ]]
then
    to_name="$from_name"
fi

from_file="${dot_dir}/${from_name}"
if [[ ! -f "$from_file" ]] && [[ ! -d "$from_file" ]]
then
    >&2 echo "Error: ${from_file} missing."
    exit 1
fi

to_file="${HOME}/.${dest_name}"

# Error if dot file exists but is not a symlink.
if [[ -f "$to_file" ]] && [[ ! -L "$to_file" ]]
then
    >&2 echo "Error: ${to_file} already exists, and is not a symlink."
    exit 1
fi

rm -f "$to_file"
ln -s "$from_file" "$to_file"
