#!/usr/bin/env bash
set -Eeu -o pipefail

# Global find and replace in files using sed.

pattern="$1"
replacement="$2"

# Check for unescaped slashes.
if echo "$pattern" | grep -q "/" &&
    echo "$pattern" | grep -Fqv "\\"
then
    >&2 echo "Error: Unescaped '/' detected in pattern."
fi

if echo "$replacement" | grep -q "/" &&
    echo "$replacement" | grep -Fqv "\\"
then
    >&2 echo "Error: Unescaped '/' detected in replacement."
fi

find . -maxdepth 1 -type f -exec sed -i "s/${pattern}/${replacement}/g" {} \;
