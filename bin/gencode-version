#!/usr/bin/env bash
set -Eeu -o pipefail

# shellcheck source=/dev/null
source "$(koopa header bash)"



# Usage                                                                     {{{1
# ==============================================================================

usage() {
cat << EOF
usage: gencode-version [--help|-h]

GENCODE release version.

optional arguments:
    --help, -h
        Show this help message and exit.

details:
    Extract the GENCODE release version from the website.

    Note that the FTP server can list releases that are in development ahead of
    the public release listed on the website, so scrape the HTML instead.

note:
    Bash script.
    Updated 2019-09-22.
EOF
}



# Parse arguments                                                           {{{1
# ==============================================================================

case "${1:-}" in
    "")
        ;;
    --help|-h)
        usage
        exit
        ;;
    *)
        >&2 printf "Error: Unsupported argument: '%s'\n" "$1"
        exit 1
        ;;
esac



# Script                                                                    {{{1
# ==============================================================================

_koopa_assert_is_installed wget

# Human.
url="https://www.gencodegenes.org/human/"
human="$( \
    wget -q -O - "$url" | \
    grep -Eo "Release [0-9]+" | \
    head -n 1 | \
    cut -d ' ' -f 2 \
)"
printf "human: %s\n" "$human"

# Mouse.
url="https://www.gencodegenes.org/mouse/"
mouse="$( \
    wget -q -O - "$url" | \
    grep -Eo "Release M[0-9]+" | \
    head -n 1 | \
    cut -d ' ' -f 2 \
)"
printf "mouse: %s\n" "$mouse"
