#!/usr/bin/env bash

KOOPA_HOME="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." \
    >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${KOOPA_HOME}/shell/bash/include/header.sh"

_koopa_help "$@"
_koopa_assert_has_args "$@"



# Variables                                                                 {{{1
# ==============================================================================

base_url="https://www.gencodegenes.org"



# Arguments                                                                 {{{1
# ==============================================================================

organism="$1"



# Script                                                                    {{{1
# ==============================================================================

case "$organism" in
    "Homo sapiens")
        short_name="human"
        pattern="Release [0-9]+"
        ;;
    "Mus musculus")
        short_name="mouse"
        pattern="Release M[0-9]+"
        ;;
    *)
        _koopa_stop "Unsupported organism: '${organism}'."
        ;;
esac

url="${base_url}/${short_name}/"
wget -q -O - "$url" \
    | grep -Eo "$pattern" \
    | head -n 1 \
    | cut -d ' ' -f 2
