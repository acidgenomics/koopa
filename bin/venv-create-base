#!/usr/bin/env bash

KOOPA_HOME="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." \
    >/dev/null 2>&1 && pwd -P)"
# shellcheck source=/dev/null
source "${KOOPA_HOME}/shell/bash/include/header.sh"

_koopa_help "$@"
_koopa_assert_has_no_environments
_koopa_assert_is_installed python3 python



# Arguments                                                                 {{{1
# ==============================================================================

env_name="${1:-"base"}"
env_base_dir="${2:-"${HOME}/.virtualenvs"}"

env_dir="${env_base_dir}/${env_name}"
pip_exe="${env_dir}/bin/pip"



# Script                                                                    {{{1
# ==============================================================================

rm -frv "$env_dir"
python3 -m venv "$env_dir"
"$pip_exe" install --upgrade pip
"$pip_exe" install black flake8 pyflakes pylint pytest pytest-flake8
"$pip_exe" list

_koopa_message "Python '${env_name}' environment installed successfully."
_koopa_note "Restart the shell."
