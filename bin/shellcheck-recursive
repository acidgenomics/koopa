#!/usr/bin/env bash
set -Eeu -o pipefail

# Recursively run shellcheck on all scripts in a directory.
# Modified 2019-06-18.

# shellcheck source=/dev/null
source "${KOOPA_DIR}/shell/bash/include/functions.sh"

assert_is_installed shellcheck

path="${1:-$PWD}"

# Legacy method:
# > find "$path" -name "*.sh" -exec shellcheck {} \;

# This step recursively grep matches files with regular expressions.
# Here we're checking for the shebang, rather than relying on file extension.
grep -Elr '#!/usr/bin/env (ba)?sh' "$path" | xargs -I {} shellcheck {}
