#!/usr/bin/env bash
set -Eeuo pipefail

# Docker
# https://docs.docker.com/install/linux/docker-ce/centos/

# Run preflight initialization checks.
script_dir="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null 2>&1 && pwd)"
# shellcheck source=/dev/null
. "${script_dir}/__init__.sh"

sudo yum remove -y \
    docker \
    docker-client \
    docker-client-latest \
    docker-common \
    docker-latest \
    docker-latest-logrotate \
    docker-logrotate \
    docker-engine

sudo yum install -y \
    yum-utils \
    device-mapper-persistent-data \
    lvm2

sudo yum-config-manager \
    --add-repo \
    https://download.docker.com/linux/centos/docker-ce.repo

sudo yum install -y \
    docker-ce \
    docker-ce-cli \
    containerd.io

sudo groupadd docker
sudo service docker restart
sudo gpasswd -a "$USER" docker
newgrp docker

command -v docker
docker --version

