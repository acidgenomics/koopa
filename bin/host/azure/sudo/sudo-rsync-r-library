#!/usr/bin/env bash
set -Eeuo pipefail

# Sync R library across virtual machines.

echo "Syncing R library from VM45."

source="mike@10.100.100.145"
r_dir="/data00/R"

# Create R directory, if necessary.
if [[ ! -d "$r_dir" ]]
then
    sudo mkdir -p "$r_dir"
    sudo chown "mike:biogroup" "$r_dir"
fi

# Symlink R directory, if necessary.
if [[ ! -L "${HOME}/R" ]]
then
    rm -rf "${HOME}/R"
    ln -s "$r_dir" "${HOME}/R"
fi

rsync -av --delete "${source}:${HOME}/R/" "${HOME}/R/"
